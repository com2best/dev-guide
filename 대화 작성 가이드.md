# 대화 작성 가이드
---

### Call 활용법

Call은 Output Action들 중 가장 많이 쓰이는 Action입니다. Call을 쓰는 목적은 여러가지가 있을 수 있습니다.

1. 대화 단위의 재사용을 위해서

같은 output을 가진 대화가 반복적으로 구성되는 경우, Call을 사용하여 기존 대화단위를 재사용 할 수 있습니다. 이런 경우엔 보통 같은 부모 대화단위 아래에 구성하는 것이 일반적입니다.

2. 대화 흐름의 이동을 위해서

대화 단위에서 대화 단위로 이동하기 위해서 Call을 사용하기도 합니다.

3. 1 Depth 인식을 위해서

2 Depth 이하의 대화단위는 글로벌하게 검색되지 않습니다. 하위 대화단위가 필요하고, 또 그것이 글로벌하게 검색되게 하고 싶을때, Call을 사용합니다.

### 리스트와 if true - repeat 활용법

리스트를 보여주고 선택을 해야하는 대화시나리오를 짜야 하는 상황이 자주 발생할 수 있습니다. (예시 사진 참조) 그런 경우에 사용자가 리스트에서 선택을 하지 않고 다른 답변을 할때, "답변없음" 등의 대화단위로 가게 됩니다. 하지만, 여기서 리스트 대화단위에서 나가지 않고 계속 선택할 수 있게 기회를 주는 방법이 더욱 선호됩니다. 그런 경우에는 하위 대화 단위 중 제일 아래에 (우선순위가 제일 낮은) 대화단위를 만들고 input: 'if (true)', output: 'Action의 repeat'으로 설정하세요. 추가적으로 repeat에 option으로 '리스트에서 선택해주세요' 등의 말을 덧붙이면 완성도가 더욱 높을 것입니다.

### 1Depth 대화단위 활용법

"시작"대화 단위에 연결된 1 Depth 대화단위를 잘 활용하는 것이 중요합니다. 대화 흐름에 따라 하위 자손 대화단위에서 검색이 되지 않은 경우 1Depth의 대화단위에서 다시 검색하기 때문에, 1 Depth에 있는 대화단위는 글로벌 대화단위라고 보아도 옳습니다. 하지만, 우선순위는 공통대화단위, 하위 자손 대화단위 아래라는 것을 명심해야합니다.

### 공통 대화단위 - up 활용법

공통 대화단위는 대화 검색에 있어서 항상 우선순위를 가지기 때문에, 여러모로 유용합니다. 공통대화 단위 또한 1 Depth의 대화단위와 마찬가지로 글로벌 대화단위라고 보아도 무방하지만, 아래와 같은 차이점이 있습니다.

* 하위 자손 대화단위에서 검색이 실패했을때, 1Depth 대화단위에서 검색이 되면 거기서부터 검색이 다시 시작됩니다. 즉, 원래의 대화단위그룹을 벗어나게 됩니다. 반면에 공통 대화단위는 마지막 대화단위의 하위 대화단위 같이 작동하기 때문에, 기존 그룹에서 유지가 됩니다. 이러한 특성 때문에, 공통 대화단위에서 up을 사용하는 것은 가장 흔하게 사용되는 예시입니다. 공통 대화단위로 input: '이전', ouput: 'Action의 up'을 등록해놓으면, 언제 어디서든 up을 작동 시킬 수 있습니다.
* 1 Depth의 대화단위는 하위 자손 대화단위보다 우선순위가 낮은 반면에, 공통 대화단위는 무엇보다 우선순위가 높습니다. 그러므로 공통 대화단위를 구성할때는 시나리오 상의 대화단위들과 input의 겹치는 부분이 없는지 고려해야합니다.

### CallChild 활용 예시

CallChild는 하위 단위의 재검색을 위해서 사용합니다. 아래 예시를 통해 CallChild의 활용 방법을 배워보겠습니다.

다음의 예시는 상담을 해주는 봇의 FAQ 대화 그룹입니다. 각 대화단위의 내용입니다.

"FAQ재검색", "FAQ재검색2" 두가지 대화단위에서 CallChild Action을 사용하고 있습니다. 아래는 FAQ재검색이 작동하는 알고리즘에 대한 상세설명입니다.

* FAQ재검색 : FAQ검색에서 "FAQ 검색"(faqtype)을 통해 받은 답변 데이터를 출력하고, "FAQ 선택"에서 listType을 이용하여 그 중 하나를 선택합니다. 만약 답변을 선택하지 않고 다른 말(예:A)을 한다면, "FAQ재검색"에서 다시 "faqtype"을 체크하게 되고, 검색된 결과 값이 있으면, CallChild로 "FAQ"를 호출합니다. CallChild로 호출되었기 때문에, "FAQ"의 하위 대화단위인 "FAQ검색"과 "미검색" 대화단위에 차례로 A라는 입력으로 재검색합니다. (이미 "FAQ재검색"에서 검색되었기 때문에, Input이 같은 "FAQ검색"도 당연히 검색되는 거겠죠?)
















<!--stackedit_data:
eyJoaXN0b3J5IjpbLTIwMjY1MDY3MzVdfQ==
-->